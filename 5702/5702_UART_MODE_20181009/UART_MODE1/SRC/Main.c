//Program Size: data=52.2 xdata=0 code=579
//HexConvertVer = V22
//CheckSum = 0xB3E8
//2018.08.27_V2.2
#include "Main.h"
#include "UART.h"
#include "Timer0.h"

//=============================================================================================================//
// main loop
//=============================================================================================================//
void main(void)
{
	Systeminit();																					//系统初始化
	Timer0init();																					//T0初始化
	UART1init();																					//UART1初始化
	EAL = 1;																						  //使能总中断
	while(1)
	{
		WDTR = 0x5a;
		UARTrespond();																			
	}	
}

//=============================================================================================================//
// System init
//=============================================================================================================//
void Systeminit(void)
{
//系统时钟寄存器,From 最大跑8M	
//====================================================================================//
	CLKSEL = 0x07;																				// Fcpu = 32M/2 = 16M
	CLKCMD = 0x69;				
	CKCON = 0x30;																					// From = 8M
	
//清看门狗
//====================================================================================//	
	WDTR = 0x5A;                   												 // clear watchdog 	

//GPIO初始化,	UTX(P05)初始化输出高,URX(P06)初始化输入上拉模式
//====================================================================================//	
	P0 = 0x20;
	P0M = 0x20;
	P0UR = 0xff;
	
	P1 = 0;
	P1M = 0;
	P1UR = 0xff;
	
	P2 = 0;
	P2M = 0;
	P2UR = 0xff;
		
}