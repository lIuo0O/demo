C51 COMPILER V9.56.0.0   ISR                                                               09/30/2018 14:06:26 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE ISR
OBJECT MODULE PLACED IN .\Output\ISR.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE SRC\ISR.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\SRC) DEBUG OBJECTEXTEND PRIN
                    -T(.\LST\ISR.lst) TABS(2) OBJECT(.\Output\ISR.obj)

line level    source

   1          // Function List:
   2          // 0. INT0                #define ISRInt0    0
   3          // 1. Timer0              #define ISRTimer0  1
   4          // 2. Timer1              #define ISRTimer1  3
   5          // 3. Uart                #define ISRUart    4
   6          // 4. Timer2              #define ISRTimer2  5
   7          // 5. I2C                 #define ISRI2c     8
   8          // 6. SPI                 #define ISRSpi     9
   9          // 7. Timer2 com(1)       #define ISRCom1    10
  10          // 8. Timer2 com(2)       #define ISRCom2    11
  11          // 9. Timer2 com(3)       #define ISRCom3    12
  12          // 10. Timer2 com(4)      #define ISRCom4    13
  13          // 11. PWM1               #define ISRPwm1    16
  14          // 12. ADC                #define ISRAdc     17
  15          // The system clock frequency is IHRC 32MHz
  16          
  17          #include "ISR.h"
  18          
  19          //===================================================================================================//
  20          //ISR init
  21          //===================================================================================================//
  22          void ISRinit(void)
  23          {
  24   1        EX0 = 1;                                  // Int 0 isr enable
  25   1      
  26   1        ET0 = 1;                                  // Timer 0 isr enable
  27   1      
  28   1        ET1 = 1;                                  // Timer 1 isr enable
  29   1      
  30   1        ES0 = 1;                                  // Uart isr enable
  31   1      
  32   1        ET2 = 1;                                  // Timer2 interrupt enable
  33   1      
  34   1        EI2C = 1;                                 // I2C interrupt enable
  35   1      
  36   1        ESPI = 1;                                 // SPI interrupt enable
  37   1      
  38   1        ET2C3 = 1;                                // Timer 2 com(3) interrupt enable
  39   1        ET2C2 = 1;                                // Timer 2 com(2) interrupt enable
  40   1        ET2C1 = 1;                                // Timer 2 com(1) interrupt enable
  41   1        ET2C0 = 1;                                // Timer 2 com(0) interrupt enable
  42   1      
  43   1        IEN4 |= 0x80;                             // PWM1 interrupt enable (EPWM1)
  44   1      
  45   1        IEN2 |= 0x02;                             // ADC interrupt enable (EADC)    
  46   1        
  47   1        EAL = 1;                                  // Interrupt enable
  48   1        
  49   1        IP0 = L_ISR_IP0;
  50   1        IP1 = L_ISR_IP1;
  51   1      }
  52          
  53          //===================================================================================================//
  54          //中断程序
C51 COMPILER V9.56.0.0   ISR                                                               09/30/2018 14:06:26 PAGE 2   

  55          //===================================================================================================//
  56          //外部中断0
  57          void INT0_ISR(void) interrupt ISRInt0         // Vector @  0x03
  58          {
  59   1          // auto clear int0 flag
  60   1          IE0 = 0;                                  // Clear INT0 flag
  61   1      }
  62          //定时器T0中断
  63          void Timer0_ISR(void) interrupt ISRTimer0     // Vector @  0x0B
  64          {
  65   1          // auto clear timer0 flag
  66   1          // TF0 = 0;                               // Clear Timer0 overflow flag
  67   1      }
  68          //定时器T1中断
  69          void Timer1_ISR(void) interrupt ISRTimer1     // Vector @  0x1B
  70          {
  71   1          // auto clear timer1 flag
  72   1          // TF1 = 0;                               // Clear Timer1 overflow flag
  73   1      }
  74          //Uart中断
  75          void Uart_ISR(void) interrupt ISRUart         // Vector @  0x23
  76          {
  77   1          TI0 = 0;                                  // Clear transfer flag
  78   1          RI0 = 0;                                  // Clear receiver flag
  79   1      }
  80          //定时器T2中断
  81          void Timer2_ISR(void) interrupt ISRTimer2     // Vector @  0x2B
  82          {
  83   1          TF2 = 0;                                  // Clear Timer 2 overflow flag
  84   1          TF2RL = 0;                                // Clear Timer 2 external reload flag
  85   1      }
  86          //I2C中断
  87          void I2C_ISR(void) interrupt ISRI2c           // Vector @  0x43
  88          {
  89   1          I2CCON &= 0xF7;                           // Clear I2C flag (SI)        
  90   1      }
  91          //SPI中断
  92          void SPI_ISR(void) interrupt ISRSpi           // Vector @  0x4B
  93          {
  94   1          SPSTA &= 0x7F;                            // SPIF cleared by reading SPSTA.
  95   1          SPSTA &= 0xEF;                            // MODF cleared by SSN is at appropriate level and SPCON be writed
  96   1      }
  97          
  98          //T2 COM1中断
  99          void COM0_ISR(void) interrupt ISRCom1         // Vector @  0x53
 100          {
 101   1          // auto clear timer2 com0 flag
 102   1          //TF2C0 = 0;                              // Clear timer2 com0 interrupt edge flag
 103   1      }
 104          //T2 COM2中断
 105          void COM1_ISR(void) interrupt ISRCom2         // Vector @  0x5B
 106          {
 107   1          // auto clear timer2 com1 flag
 108   1          //TF2C1 = 0;                              // Clear timer2 com1 interrupt edge flag
 109   1      }
 110          //T2 COM3中断
 111          void COM2_ISR(void) interrupt ISRCom3         // Vector @  0x63
 112          {
 113   1          // auto clear timer2 com2 flag
 114   1          //TF2C2 = 0;                              // Clear timer2 com2 interrupt edge flag
 115   1      }
 116          //T2 COM4中断
C51 COMPILER V9.56.0.0   ISR                                                               09/30/2018 14:06:26 PAGE 3   

 117          void COM3_ISR(void) interrupt ISRCom4         // Vector @  0x6B
 118          {
 119   1          // auto clear timer2 com0 flag
 120   1          //TF2C3 = 0;                              // Clear timer2 com3 interrupt edge flag
 121   1      }
 122          //PWM1 中断
 123          void PWM1_ISR(void) interrupt ISRPwm1         // Vector @  0x83
 124          {
 125   1          IEN4 &= 0xF7;                             // Clear PWM1 request (PWM1F)    
 126   1      }
 127          
 128          //--------------------------------------------------------------------------------------------------------
             ----
 129          void ADC_ISR(void) interrupt ISRAdc           // Vector @  0x9B
 130          {
 131   1          IRCON2 &= 0xFB;                           // Clear ADC interrupt edge flag (ADCF)
 132   1      }
 133          
 134          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     75    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
