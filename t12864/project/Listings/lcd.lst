C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\lcd.obj
COMPILER INVOKED BY: D:\software\keil5\C51\BIN\C51.EXE ..\c\lcd.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\c;..\h) DEBUG OBJEC
                    -TEXTEND CODE LISTINCLUDE SYMBOLS PRINT(.\Listings\lcd.lst) OBJECT(.\Objects\lcd.obj)

line level    source

   1          #include <sn8f5804.h>
   1      =1  /*--------------------------------------------------------------------------
   2      =1  SN8F5804.H
   3      =1  
   4      =1  Header file for SNOiX SN8F5804 microcontroller.
   5      =1  Copyright (c) 2015 SONiX Technology Co., Ltd.
   6      =1  
   7      =1  Version 1.0    2015-08-19
   8      =1  Version 1.3    2015-09-09
   9      =1  Version 1.7    2015-10-14
  10      =1  --------------------------------------------------------------------------*/
  11      =1  
  12      =1  #ifndef __SN8F5804_H__
  13      =1  #define __SN8F5804_H__
  14      =1  
  15      =1  /*      Register      */
  16      =1  sfr     P0       = 0x80;
  17      =1    sbit  P07      = P0^7;
  18      =1    sbit  P06      = P0^6;
  19      =1    sbit  P05      = P0^5;
  20      =1    sbit  P04      = P0^4;
  21      =1    sbit  P03      = P0^3;
  22      =1    sbit  P02      = P0^2;
  23      =1    sbit  P01      = P0^1;
  24      =1    sbit  P00      = P0^0;
  25      =1  sfr     SP       = 0x81;
  26      =1  sfr     DPL      = 0x82;
  27      =1  sfr     DPH      = 0x83;
  28      =1  sfr     WDTR     = 0x86;
  29      =1  sfr     PCON     = 0x87;
  30      =1  sfr     TCON     = 0x88;
  31      =1    sbit  TF1      = TCON^7;
  32      =1    sbit  TR1      = TCON^6;
  33      =1    sbit  TF0      = TCON^5;
  34      =1    sbit  TR0      = TCON^4;
  35      =1    sbit  IE1      = TCON^3;
  36      =1    sbit  IE0      = TCON^1;
  37      =1  sfr     TMOD     = 0x89;
  38      =1  sfr     TL0      = 0x8A;
  39      =1  sfr     TL1      = 0x8B;
  40      =1  sfr     TH0      = 0x8C;
  41      =1  sfr     TH1      = 0x8D;
  42      =1  sfr     CKCON    = 0x8E;
  43      =1  sfr     PEDGE    = 0x8F;
  44      =1  sfr     P1       = 0x90;
  45      =1    sbit  P17      = P1^7;
  46      =1    sbit  P16      = P1^6;
  47      =1    sbit  P15      = P1^5;
  48      =1    sbit  P14      = P1^4;
  49      =1    sbit  P13      = P1^3;
  50      =1    sbit  P12      = P1^2;
  51      =1    sbit  P11      = P1^1;
  52      =1    sbit  P10      = P1^0;
  53      =1  sfr     P1W      = 0x91;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 2   

  54      =1  sfr     DPC      = 0x93;
  55      =1  sfr     PECMD    = 0x94;
  56      =1  sfr16   PEROM    = 0x95;
  57      =1  sfr     PEROML   = 0x95;
  58      =1  sfr     PEROMH   = 0x96;
  59      =1  sfr     PERAM    = 0x97;
  60      =1  sfr     S0CON    = 0x98;
  61      =1    sbit  SM0      = S0CON^7;
  62      =1    sbit  SM1      = S0CON^6;
  63      =1    sbit  SM20     = S0CON^5;
  64      =1    sbit  REN0     = S0CON^4;
  65      =1    sbit  TB80     = S0CON^3;
  66      =1    sbit  RB80     = S0CON^2;
  67      =1    sbit  TI0      = S0CON^1;
  68      =1    sbit  RI0      = S0CON^0;
  69      =1  sfr     S0BUF    = 0x99;
  70      =1  sfr     IEN2     = 0x9A;
  71      =1  sfr     P0CON    = 0x9E;
  72      =1  sfr     P1CON    = 0x9F;
  73      =1  sfr     P2       = 0xA0;
  74      =1    sbit  P27      = P2^7;
  75      =1    sbit  P26      = P2^6;
  76      =1    sbit  P25      = P2^5;
  77      =1    sbit  P24      = P2^4;
  78      =1    sbit  P23      = P2^3;
  79      =1    sbit  P22      = P2^2;
  80      =1    sbit  P21      = P2^1;
  81      =1    sbit  P20      = P2^0;
  82      =1  sfr     LCDCON   = 0xA1;
  83      =1  sfr     LCDMOD   = 0xA2;
  84      =1  sfr     LCDSEG   = 0xA3;
  85      =1  sfr     LCDBUF   = 0xA4;
  86      =1  sfr     LCDADR   = 0xA5;
  87      =1  sfr     CSCON    = 0xA6;
  88      =1  sfr     CSMOD    = 0xA7;
  89      =1  sfr     IEN0     = 0xA8;
  90      =1    sbit   EAL     = IEN0^7;
  91      =1    sbit   ET2     = IEN0^5;
  92      =1    sbit   ES0     = IEN0^4;
  93      =1    sbit   ET1     = IEN0^3;
  94      =1    sbit   EX1     = IEN0^2;
  95      =1    sbit   ET0     = IEN0^1;
  96      =1    sbit   EX0     = IEN0^0;
  97      =1  sfr     IP0      = 0xA9;
  98      =1  sfr     S0RELL   = 0xAA;
  99      =1  sfr     PW1M     = 0xAB;
 100      =1  sfr16   PW1Y     = 0xAC;
 101      =1  sfr     PW1YL    = 0xAC;
 102      =1  sfr     PW1YH    = 0xAD;
 103      =1  sfr16   PW1B     = 0xAE;
 104      =1  sfr     PW1BL    = 0xAE;
 105      =1  sfr     PW1BH    = 0xAF;
 106      =1  sfr     P3       = 0xB0;
 107      =1    sbit  P31      = P3^1;
 108      =1    sbit  P30      = P3^0;
 109      =1  sfr     CSC      = 0xB1;
 110      =1  sfr     CYC      = 0xB2;
 111      =1  sfr     ACNT     = 0xB3;
 112      =1  sfr     BCNT     = 0xB4;
 113      =1  sfr     CCNT     = 0xB5;
 114      =1  sfr     DCNT     = 0xB6;
 115      =1  sfr     PWFLM    = 0xB7;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 3   

 116      =1  sfr     IEN1     = 0xB8;
 117      =1    sbit  ET2RL    = IEN1^7;
 118      =1    sbit  ET2C3    = IEN1^5;
 119      =1    sbit  ET2C2    = IEN1^4;
 120      =1    sbit  ET2C1    = IEN1^3;
 121      =1    sbit  ET2C0    = IEN1^2;
 122      =1    sbit  ESPI     = IEN1^1;
 123      =1    sbit  EI2C     = IEN1^0;
 124      =1  sfr     IP1      = 0xB9;
 125      =1  sfr     S0RELH   = 0xBA;
 126      =1  sfr16   PW1D     = 0xBB;
 127      =1  sfr     PW1DL    = 0xBB;
 128      =1  sfr     PW1DH    = 0xBC;
 129      =1  sfr     PW1A     = 0xBD;
 130      =1  sfr     PW1CH    = 0xBE;
 131      =1  sfr     IRCON2   = 0xBF;
 132      =1  sfr     IRCON    = 0xC0;
 133      =1    sbit   TF2RL   = IRCON^7;
 134      =1    sbit   TF2     = IRCON^6;
 135      =1    sbit   TF2C3   = IRCON^5;
 136      =1    sbit   TF2C2   = IRCON^4;
 137      =1    sbit   TF2C1   = IRCON^3;
 138      =1    sbit   TF2C0   = IRCON^2;
 139      =1  sfr     CCEN     = 0xC1;
 140      =1  sfr     CCL1     = 0xC2;
 141      =1  sfr     CCH1     = 0xC3;
 142      =1  sfr     CCL2     = 0xC4;
 143      =1  sfr     CCH2     = 0xC5;
 144      =1  sfr     CCL3     = 0xC6;
 145      =1  sfr     CCH3     = 0xC7;
 146      =1  sfr     T2CON    = 0xC8;
 147      =1    sbit  T2PS     = T2CON^7;
 148      =1    sbit  I3FR     = T2CON^6;
 149      =1    sbit  GF1      = T2CON^5;
 150      =1    sbit  T2R1     = T2CON^4;
 151      =1    sbit  T2R0     = T2CON^3;
 152      =1    sbit  T2CM     = T2CON^2;
 153      =1    sbit  T2I1     = T2CON^1;
 154      =1    sbit  T2I0     = T2CON^0;
 155      =1  sfr     CRCL     = 0xCA;
 156      =1  sfr     CRCH     = 0xCB;
 157      =1  sfr     TL2      = 0xCC;
 158      =1  sfr     TH2      = 0xCD;
 159      =1  sfr     CSRS     = 0xCE;
 160      =1  sfr     PSW      = 0xD0;
 161      =1    sbit  CY       = PSW^7;
 162      =1    sbit  AC       = PSW^6;
 163      =1    sbit  F0       = PSW^5;
 164      =1    sbit  RS1      = PSW^4;
 165      =1    sbit  RS0      = PSW^3;
 166      =1    sbit  OV       = PSW^2;
 167      =1    sbit  F1       = PSW^1;
 168      =1    sbit  P        = PSW^0;
 169      =1  sfr     ADM      = 0xD2;
 170      =1  sfr     ADB      = 0xD3;
 171      =1  sfr     ADR      = 0xD4;
 172      =1  sfr     VREFH    = 0xD5;
 173      =1  sfr     P2CON    = 0xD6;
 174      =1  sfr     P3CON    = 0xD7;
 175      =1  sfr     S0CON2   = 0xD8;
 176      =1    sbit  BD       = S0CON2^7;
 177      =1  sfr     ADT      = 0xD9;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 4   

 178      =1  sfr     I2CDAT   = 0xDA;
 179      =1  sfr     I2CADR   = 0xDB;
 180      =1  sfr     I2CCON   = 0xDC;
 181      =1  sfr     I2CSTA   = 0xDD;
 182      =1  sfr     SMBSEL   = 0xDE;
 183      =1  sfr     SMBDST   = 0xDF;
 184      =1  sfr     ACC      = 0xE0;
 185      =1  sfr     SPSTA    = 0xE1;
 186      =1  sfr     SPCON    = 0xE2;
 187      =1  sfr     SPDAT    = 0xE3;
 188      =1  sfr     P0OC     = 0xE4;
 189      =1  sfr     CLKSEL   = 0xE5;
 190      =1  sfr     CLKCMD   = 0xE6;
 191      =1  sfr     TCON0    = 0xE7;
 192      =1  sfr     B        = 0xF0;
 193      =1  sfr     P0UR     = 0xF1;
 194      =1  sfr     P1UR     = 0xF2;
 195      =1  sfr     P2UR     = 0xF3;
 196      =1  sfr     P3UR     = 0xF4;
 197      =1  sfr     SRST     = 0xF7;
 198      =1  sfr     P0M      = 0xF9;
 199      =1  sfr     P1M      = 0xFA;
 200      =1  sfr     P2M      = 0xFB;
 201      =1  sfr     P3M      = 0xFC;
 202      =1  sfr     PFLAG    = 0xFF;
 203      =1  
 204      =1  /*      Interrupt Vector      */
 205      =1  #define ISRInt0    0
 206      =1  #define ISRTimer0  1
 207      =1  #define ISRInt1    2
 208      =1  #define ISRTimer1  3
 209      =1  #define ISRUart    4
 210      =1  #define ISRTimer2  5
 211      =1  #define ISRI2c     8
 212      =1  #define ISRSpi     9
 213      =1  #define ISRCom0    10
 214      =1  #define ISRCom1    11
 215      =1  #define ISRCom2    12
 216      =1  #define ISRCom3    13
 217      =1  #define ISRCS      16
 218      =1  #define ISRAdc     17
 219      =1  #define ISRPwm1    18
 220      =1  #define ISRInt2    29
 221      =1  
 222      =1  /*      C51 Macros      */
 223      =1  #ifdef __C51__
 224      =1  #include <intrins.h>
   1      =2  /*--------------------------------------------------------------------------
   2      =2  INTRINS.H
   3      =2  
   4      =2  Intrinsic functions for C51.
   5      =2  Copyright (c) 1988-2010 Keil Elektronik GmbH and ARM Germany GmbH
   6      =2  All rights reserved.
   7      =2  --------------------------------------------------------------------------*/
   8      =2  
   9      =2  #ifndef __INTRINS_H__
  10      =2  #define __INTRINS_H__
  11      =2  
  12      =2  #pragma SAVE
  13      =2  
  14      =2  #if defined (__CX2__)
           =2 #pragma FUNCTIONS(STATIC)
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 5   

           =2 /* intrinsic functions are reentrant, but need static attribute */
           =2 #endif
  18      =2  
  19      =2  extern void          _nop_     (void);
  20      =2  extern bit           _testbit_ (bit);
  21      =2  extern unsigned char _cror_    (unsigned char, unsigned char);
  22      =2  extern unsigned int  _iror_    (unsigned int,  unsigned char);
  23      =2  extern unsigned long _lror_    (unsigned long, unsigned char);
  24      =2  extern unsigned char _crol_    (unsigned char, unsigned char);
  25      =2  extern unsigned int  _irol_    (unsigned int,  unsigned char);
  26      =2  extern unsigned long _lrol_    (unsigned long, unsigned char);
  27      =2  extern unsigned char _chkfloat_(float);
  28      =2  #if defined (__CX2__)
           =2 extern int           abs       (int);
           =2 extern void          _illop_   (void);
           =2 #endif
  32      =2  #if !defined (__CX2__)
  33      =2  extern void          _push_    (unsigned char _sfr);
  34      =2  extern void          _pop_     (unsigned char _sfr);
  35      =2  #endif
  36      =2  
  37      =2  #pragma RESTORE
  38      =2  
  39      =2  #endif
  40      =2  
 225      =1  #define IDLE() {unsigned char data var_idle=PCON; var_idle |= 0x01; PCON = var_idle; }
 226      =1  #define STOP() {if (EAL == 0) {PCON |= 0x02;} else {EAL = 0; PCON |= 0x02; EAL = 1;}}
 227      =1  #define PISP(ROM_ADDRESS, RAM_ADDRESS) {PERAM = (RAM_ADDRESS); PEROM = ((ROM_ADDRESS) & 0xFFE0); if (EAL =
             -= 0) {PECMD = 0x5A; _nop_(); _nop_();} else {EAL = 0; PECMD = 0x5A; _nop_(); _nop_(); EAL = 1;}}
 228      =1  #define BISP(ROM_ADDRESS, RAM_ADDRESS) {PERAM = (RAM_ADDRESS); PEROM = ((ROM_ADDRESS) & 0xFFFF); if (EAL =
             -= 0) {PECMD = 0x1E; _nop_(); _nop_();} else {EAL = 0; PECMD = 0x1E; _nop_(); _nop_(); EAL = 1;}}
 229      =1  
 230      =1  #endif  // __C51__
 231      =1  
 232      =1  #ifndef uint8_t
 233      =1  #define uint8_t unsigned char
 234      =1  #endif  // uint8_t
 235      =1  
 236      =1  #ifndef uint16_t
 237      =1  #define uint16_t unsigned int
 238      =1  #endif  // uint16_t
 239      =1  
 240      =1  #ifndef uint32_t
 241      =1  #define uint32_t unsigned long
 242      =1  #endif  // uint32_t
 243      =1  
 244      =1  #endif  // __SN8F5804_H__
   2          #include "lcd.h"
   1      =1  #ifndef __LCD_H
   2      =1  #define __LCD_H
   3      =1  
   4      =1  #define  LCD_SERIAL                  0x00
   5      =1  #define  LCD_PARALLEL                0x01
   6      =1  
   7      =1  #define  LCD_PSB_MODE                LCD_SERIAL
   8      =1  
   9      =1  #define  DELAY_MS_START              0x29b
  10      =1  
  11      =1  #define  CMD_TYPE                    0x00
  12      =1  #define  DATA_TYPE                   0x01
  13      =1  
  14      =1  #define  LCD_ON                      0x01
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 6   

  15      =1  #define  LCD_OFF                     0x00
  16      =1  
  17      =1  
  18      =1  #define  LCD_TEXT_MODE               0x30
  19      =1  #define  LCD_GRAPH_MODE              0x36
  20      =1  
  21      =1  #define  DELAY_NMS                   0x03
  22      =1  #define  DELAY_NUS                   0x0a
  23      =1  
  24      =1  #define  LCD_LEN                     0x40
  25      =1  
  26      =1  #define  STRS_LEN                    0x0c
  27      =1  
  28      =1  #define  GUI2_HEAD_LEN               0x05
  29      =1  #define  ROW1_HEAD                   0x80
  30      =1  #define  ROW2_HEAD                   0x90
  31      =1  #define  ROW3_HEAD                   0x88
  32      =1  #define  ROW4_HEAD                   0x98
  33      =1  
  34      =1  #define  ROW1_BODY                   0x82
  35      =1  #define  ROW2_BODY                   0x92
  36      =1  #define  ROW3_BODY                   0x8a
  37      =1  #define  ROW4_BODY                   0x9a
  38      =1  
  39      =1  #define  BUFFER_LEN                  0x0c
  40      =1  //BUFFER_LEN 不良描述固定占用12个字符
  41      =1  
  42      =1  #define  GUI3_ROW_LEN                0x0b
  43      =1  
  44      =1  struct Lcd {
  45      =1      
  46      =1      unsigned char gui_id;
  47      =1      
  48      =1      unsigned char buffer[STRS_LEN];
  49      =1  
  50      =1      
  51      =1      unsigned char pos;                  // 行定入时的行首定位
  52      =1      unsigned char *str;                 // 
  53      =1      unsigned char err_index;            // 当前的错误ID下标
  54      =1      unsigned char err_len;              // err_ids 的有效长度  
  55      =1      unsigned char err_ids[BUFFER_LEN];  // http返回的错误ID列表
  56      =1      unsigned char on:1;
  57      =1      unsigned char updated:1;
  58      =1  };
  59      =1  
  60      =1  void init_lcd(void);
  61      =1  
  62      =1  void switch_lcd(unsigned char state);
  63      =1  
  64      =1  void write_byte(unsigned char type, unsigned char dat);
  65      =1  
  66      =1  void display(void);
  67      =1  
  68      =1  
  69      =1  
  70      =1  #endif
   3          /*******************************************************************************************/
   4          // 开机的欢迎界面
   5          code unsigned char gui1_row1[] = "欢迎使用";
   6          code unsigned char gui1_row2[] = "创赢高科";
   7          
   8          // 冒号后面的数据为纯ACSII码，由WIFI传输过来更新
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 7   

   9          code unsigned char gui2_row0[] = "型号";
  10          code unsigned char gui2_row1[] = "订单";
  11          code unsigned char gui2_row2[] = "合格";
  12          code unsigned char gui2_row3[] = "不良";
  13          
  14          // 单片机内部记录所有品质不良列表
  15          // 对齐为固定12个字节，然后只需要刷新
  16          code unsigned char *gui3_rows[] = {
  17                                       "            ",
  18                                       "1234跟我开始",
  19                                       "2234现在又有",
  20                                       "3234切克闹啊",
  21                                       "4goo再来一次",
  22                                       "5ort不良情况",
  23                                       "6ier不良情况",
  24                                       "7777不良情况",
  25                                       "8998不良情况",
  26                                       "9889不良情况",
  27                                       "1002不良情况",
  28          };
  29          code unsigned char *error[] = {
  30                                      "无反应      ",
  31                                      "不划线      ",
  32                                      "不烧录      ",
  33                                      "断线        ",
  34                                      "出彩线      ",
  35                                      "信号弱      ",
  36                                      "灯不亮      ",
  37                                      "自划线      ",
  38                                      "不自开机    ",
  39                                      "充电TC不转QC",
  40                                      "充电TC不转PD",
  41                                      "MC不转QC    ",
  42                                      "无静态      ",
  43                                      "不开机      ",
  44                                      "输出TC不转QC",
  45                                      "输出TC不转PD",
  46                                      "DC充电不转伏",
  47                                      "无输出      ",
  48                                      "不充电      ",
  49                                      "充电电流高  ",
  50                                      "MC不转伏    ",
  51                                      "不转伏      ",
  52                                      "屏不良      ",
  53                                      "带载不良    ",
  54                                      "灯长亮      ",
  55                                      "无声音      ",
  56                                      "排针内杂物  ",
  57                                      "USB胶芯融化 ",
  58                                      "自动熄屏    ",
  59                                      "声音小      ",
  60                                      "逆变信号    ",
  61                                      "马达不转    ",
  62                                      "马达自转    ",
  63                                      "D+D-高      ",
  64                                      "AC烧        ",
  65                                      "触摸不良    ",
  66                                      "蓝灯屏      ",
  67                                      "U2QC12V",
  68                                      "空载不良    ",
  69                                      "不关机      ",
  70          };
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 8   

  71          /*******************************************************************************************/
  72          sfr lcd_out = 0xA0;
  73          sbit vss_pin = P0^2;
  74          sbit vdd_pin = P0^3;
  75          sbit v0_pin = P0^4;
  76          // parallel
  77          sbit rs_pin = P0^5;
  78          sbit rw_pin = P0^6;
  79          sbit e_pin = P0^7;
  80          // serial
  81          sbit cs_pin = P0^5;
  82          sbit sid_pin = P0^6;
  83          sbit clk_pin = P0^7;
  84          /*******************************************************************************************/
  85          sbit psb_pin = P1^0;
  86          sbit ret_pin = P1^1;
  87          sbit led_a = P1^3;
  88          sbit led_k = P1^4;
  89          /*******************************************************************************************/
  90          struct Lcd lcd;
  91          /*******************************************************************************************/
  92          void delay_us(unsigned char n);
  93          void delay_ms(unsigned char n);
  94          void check_busy(void);
  95          void send_bit(unsigned char dat);
  96          void switch_lcd_mode(unsigned char mode);
  97          void clear_screen(void);
  98          void print_info(unsigned char pos, unsigned char *arr, unsigned char len);
  99          /*******************************************************************************************/
 100          void switch_lcd(unsigned char state){
 101   1          unsigned char i = 0;
 102   1          if(state == LCD_ON){
 103   2              if(lcd.on) return;
 104   2              ret_pin = 1;
 105   2              vss_pin = 0;
 106   2              vdd_pin = 1;
 107   2              v0_pin = 1;
 108   2              led_a = 1;
 109   2              led_k = 0;
 110   2              #if (LCD_PSB_MODE == LCD_PARALLEL)
                      psb_pin = 1;
                      rs_pin = 0;
                      rw_pin = 0;
                      e_pin = 0;
                      #elif (LCD_PSB_MODE == LCD_SERIAL)
 116   2              psb_pin = 0;
 117   2              cs_pin = 0;
 118   2              sid_pin = 0;
 119   2              clk_pin = 0;
 120   2              #endif
 121   2              delay_ms(40); 
 122   2              write_byte(CMD_TYPE, 0x30);          // fun_instrct_set      100us   // re = 0; 0x30
 123   2              delay_ms(DELAY_NMS);
 124   2              write_byte(CMD_TYPE, 0x30);
 125   2              delay_ms(DELAY_NMS);
 126   2              write_byte(CMD_TYPE, 0x01);          // clear                 10us
 127   2              delay_ms(DELAY_NMS);
 128   2              write_byte(CMD_TYPE, 0x06);          // move right             10us
 129   2              delay_ms(DELAY_NMS);
 130   2              write_byte(CMD_TYPE, 0x0c);          // turn on                10us
 131   2              delay_ms(DELAY_NMS);
 132   2              led_a = 1;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 9   

 133   2              lcd.on = 1;
 134   2              
 135   2              // initial display
 136   2              write_byte(CMD_TYPE, 0x92);
 137   2              i = 0;
 138   2              while(i<8){
 139   3                  write_byte(DATA_TYPE, gui1_row1[i]);
 140   3                  i++;   
 141   3              }
 142   2              write_byte(CMD_TYPE, 0x8a);
 143   2              i=0;
 144   2              while(i<8){
 145   3                  write_byte(DATA_TYPE, gui1_row2[i]);
 146   3                  i++;   
 147   3              }
 148   2              delay_ms(200);
 149   2              clear_screen();
 150   2              print_info(ROW1_HEAD, gui2_row0, GUI2_HEAD_LEN);
 151   2              print_info(ROW2_HEAD, gui2_row1, GUI2_HEAD_LEN);
 152   2              print_info(ROW3_HEAD, gui2_row2, GUI2_HEAD_LEN);
 153   2              print_info(ROW4_HEAD, gui2_row3, GUI2_HEAD_LEN);
 154   2              lcd.updated = 1;
 155   2          }else{
 156   2              if(lcd.on == 0) return ;
 157   2              write_byte(CMD_TYPE, 0x08);         // reset display
 158   2              delay_ms(DELAY_NMS);
 159   2              write_byte(CMD_TYPE, 0x01);         // clear ac
 160   2              delay_ms(DELAY_NMS);
 161   2              vdd_pin = 0;                        // turn off power
 162   2              v0_pin = 0;
 163   2              led_a = 0;
 164   2              lcd.on = 0;
 165   2              lcd.updated = 0;
 166   2          }
 167   1      }
 168          /*******************************************************************************************/
 169          /*******************************************************************************************/
 170          void display(void){
 171   1          unsigned char i = 0;
 172   1          if(lcd.updated) return;
 173   1          lcd.str = error[lcd.err_ids[lcd.err_index]];          // TODO
 174   1          print_info(lcd.pos, lcd.str, BUFFER_LEN);
 175   1          lcd.updated = 1;
 176   1      }
 177          /*******************************************************************************************/
 178          #if (LCD_PSB_MODE == LCD_PARALLEL)
              void write_byte(unsigned char type, unsigned char dat){
                  if(lcd.stable){
                      check_busy();
                  }
                  rs_pin = type;
                  rw_pin = 0;
                  lcd_out = dat;
                  e_pin = 1;
                  delay_us(DELAY_NUS);
                  e_pin = 0;
                  rs_pin = 0;
                  delay_us(DELAY_NUS);
              }
              void check_busy(void){
                  unsigned char res = 0;
                  P2M = 0x00;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 10  

                  do{
                      e_pin = 0;
                      rs_pin = 0;
                      rw_pin = 1;
                      delay_us(DELAY_NUS);
                      e_pin = 1;
                      delay_us(DELAY_NUS);
                      res = (lcd_out & 0x80);
                  }while(res);
                  e_pin = 0;
                  P2M = 0xff;
              }
              /*******************************************************************************************/
              #elif (LCD_PSB_MODE == LCD_SERIAL)
 209          /**   fosc 540 khz   
 210              11111ABC, 
 211              A=H:LCD => MCU,   A=L: MCU => LCD
 212              B=H:DISPLAY_DATA, B=L:CONTROL_DATA;
 213              C = 0;
 214          **/
 215          void write_byte(unsigned char type, unsigned char dat){
 216   1          unsigned char head = 0xf8;
 217   1          clk_pin = 0;
 218   1          cs_pin = 1;
 219   1          check_busy();
 220   1          if(type){
 221   2              head |= 0x02;
 222   2          }
 223   1          send_bit(head);
 224   1          send_bit(dat&0xf0);
 225   1          send_bit(dat<<4);
 226   1          delay_us(1);
 227   1          clk_pin = 0;
 228   1          cs_pin = 0;
 229   1      }
 230          
 231          void send_bit(unsigned char dat){
 232   1          unsigned char i = 0;
 233   1          while(i<8){
 234   2              clk_pin = 0;
 235   2              sid_pin = (dat & 0x80);
 236   2              clk_pin = 1;
 237   2              dat <<= 1;
 238   2              i++;
 239   2          }
 240   1      }
 241          
 242          void check_busy(void){
 243   1          unsigned char res = 0;
 244   1      
 245   1      }
 246          #endif
 247          void clear_screen(void){
 248   1          write_byte(CMD_TYPE, 0x01); 
 249   1      }
 250          
 251          void print_info(unsigned char pos, unsigned char *arr, unsigned char len){
 252   1          unsigned char i = 0;
 253   1          write_byte(CMD_TYPE, pos);
 254   1          while(i<len){
 255   2              write_byte(DATA_TYPE, *(arr+i));
 256   2              i++;
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 11  

 257   2          }
 258   1      }
 259          /*******************************************************************************************/
 260          void delay_us(unsigned char n){
 261   1          while(n--);
 262   1      }
 263          void delay_ms(unsigned char n){
 264   1          unsigned int i = 0;
 265   1          while(n--){
 266   2              i = DELAY_MS_START;
 267   2              while(i--);
 268   2          }
 269   1      }
 270          /**
 271          void switch_lcd_mode(unsigned char mode){
 272              delay_ms(DELAY_NMS);
 273              write_byte(CMD_TYPE, mode);
 274              delay_ms(DELAY_NMS);
 275              write_byte(CMD_TYPE, mode);
 276              delay_ms(DELAY_NMS);
 277          }
 278          **/
 279          /**
 280          void init_lcd(void){
 281              unsigned char i = 0;      // config pin
 282              ret_pin = 1;
 283              vss_pin = 0;
 284              vdd_pin = 1;
 285              v0_pin = 1;
 286              led_a = 1;
 287              led_k = 0;
 288              #if (LCD_PSB_MODE == LCD_PARALLEL)
 289              psb_pin = 1;
 290              rs_pin = 0;
 291              rw_pin = 0;
 292              e_pin = 0;
 293              #elif (LCD_PSB_MODE == LCD_SERIAL)
 294              psb_pin = 0;
 295              cs_pin = 0;
 296              sid_pin = 0;
 297              clk_pin = 0;
 298              #endif
 299              delay_ms(40);                        // power_on              40ms
 300              write_byte(CMD_TYPE, 0x30);          // fun_instrct_set      100us   // re = 0; 0x30
 301              delay_ms(DELAY_NMS);
 302              write_byte(CMD_TYPE, 0x30);
 303              delay_ms(DELAY_NMS);
 304              write_byte(CMD_TYPE, 0x0f);          // turn on              100us
 305              delay_ms(DELAY_NMS);
 306              write_byte(CMD_TYPE, 0x01);          // clear                 10us
 307              delay_ms(DELAY_NMS);
 308              write_byte(CMD_TYPE, 0x06);          // display_control       10us
 309              delay_ms(DELAY_NMS);
 310          
 311              lcd.on = 1;
 312          }
 313          **/
 314          /**    ST7920
 315                      psb:     1
 316                      ret:     1
 317                    led_a:     1
 318                    led_k:     0
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 12  

 319                              rs    rw    db7    db6    db5    db4    db3    db2    db1    db0
 320                    clear:     0     0      0      0      0      0      0      0      0      1
 321             reset_cursor:     0     0      0      0      0      0      0      0      1      x
 322             access_point:     0     0      0      0      0      0      0      1     i/d     x
 323          display_control:     0     0      0      0      0      0      1      d      c      b
 324              cursor_move:     0     0      0      0      0      1     s/c    r/l     x      x
 325          fun_instrct_set:     0     0      0      0      1      1      x     re      x      x
 326                set_cgram:     0     0      0      1    ac5    ac4    ac3    ac2    ac1    ac0
 327                set_ddram:     0     0      1    ac6    ac5    ac4    ac3    ac2    ac1    ac0
 328               check_busy:     0     1     bf    ac6    ac5    ac4    ac3    ac2    ac1    ac0
 329                write_ram:     1     0    db7    db6    db5    db4    db3    db2    db1    db0
 330                 read_ram:     1     1    db7    db6    db5    db4    db3    db2    db1    db0
 331          **/
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 13  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _switch_lcd (BEGIN)
                                           ; SOURCE LINE # 100
;---- Variable 'state' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 101
0000 E4                CLR     A
0001 F500        R     MOV     i,A
                                           ; SOURCE LINE # 102
0003 EF                MOV     A,R7
0004 6401              XRL     A,#01H
0006 6003              JZ      $ + 5H
0008 020000      R     LJMP    ?C0001
                                           ; SOURCE LINE # 103
000B E500        R     MOV     A,lcd+01FH
000D 30E003            JNB     ACC.0,$ + 6H
0010 020000      R     LJMP    ?C0003
0013         ?C0002:
                                           ; SOURCE LINE # 104
0013 D291              SETB    ret_pin
                                           ; SOURCE LINE # 105
0015 C282              CLR     vss_pin
                                           ; SOURCE LINE # 106
0017 D283              SETB    vdd_pin
                                           ; SOURCE LINE # 107
0019 D284              SETB    v0_pin
                                           ; SOURCE LINE # 108
001B D293              SETB    led_a
                                           ; SOURCE LINE # 109
001D C294              CLR     led_k
                                           ; SOURCE LINE # 116
001F C290              CLR     psb_pin
                                           ; SOURCE LINE # 117
0021 C285              CLR     cs_pin
                                           ; SOURCE LINE # 118
0023 C286              CLR     sid_pin
                                           ; SOURCE LINE # 119
0025 C287              CLR     clk_pin
                                           ; SOURCE LINE # 121
0027 7F28              MOV     R7,#028H
0029 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 122
002C 7D30              MOV     R5,#030H
002E E4                CLR     A
002F FF                MOV     R7,A
0030 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 123
0033 7F03              MOV     R7,#03H
0035 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 124
0038 7D30              MOV     R5,#030H
003A E4                CLR     A
003B FF                MOV     R7,A
003C 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 125
003F 7F03              MOV     R7,#03H
0041 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 126
0044 7D01              MOV     R5,#01H
0046 E4                CLR     A
0047 FF                MOV     R7,A
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 14  

0048 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 127
004B 7F03              MOV     R7,#03H
004D 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 128
0050 7D06              MOV     R5,#06H
0052 E4                CLR     A
0053 FF                MOV     R7,A
0054 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 129
0057 7F03              MOV     R7,#03H
0059 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 130
005C 7D0C              MOV     R5,#0CH
005E E4                CLR     A
005F FF                MOV     R7,A
0060 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 131
0063 7F03              MOV     R7,#03H
0065 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 132
0068 D293              SETB    led_a
                                           ; SOURCE LINE # 133
006A 430001      R     ORL     lcd+01FH,#01H
                                           ; SOURCE LINE # 136
006D 7D92              MOV     R5,#092H
006F E4                CLR     A
0070 FF                MOV     R7,A
0071 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 137
0074 E4                CLR     A
0075 F500        R     MOV     i,A
0077         ?C0004:
                                           ; SOURCE LINE # 138
                                           ; SOURCE LINE # 139
0077 900000      R     MOV     DPTR,#gui1_row1
007A 120000      R     LCALL   L?0031
                                           ; SOURCE LINE # 140
007D 0500        R     INC     i
                                           ; SOURCE LINE # 141
007F E500        R     MOV     A,i
0081 C3                CLR     C
0082 9408              SUBB    A,#08H
0084 40F1              JC      ?C0004
0086         ?C0005:
                                           ; SOURCE LINE # 142
0086 7D8A              MOV     R5,#08AH
0088 E4                CLR     A
0089 FF                MOV     R7,A
008A 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 143
008D E4                CLR     A
008E F500        R     MOV     i,A
0090         ?C0006:
                                           ; SOURCE LINE # 144
                                           ; SOURCE LINE # 145
0090 900000      R     MOV     DPTR,#gui1_row2
0093 120000      R     LCALL   L?0031
                                           ; SOURCE LINE # 146
0096 0500        R     INC     i
                                           ; SOURCE LINE # 147
0098 E500        R     MOV     A,i
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 15  

009A C3                CLR     C
009B 9408              SUBB    A,#08H
009D 40F1              JC      ?C0006
009F         ?C0007:
                                           ; SOURCE LINE # 148
009F 7FC8              MOV     R7,#0C8H
00A1 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 149
00A4 120000      R     LCALL   clear_screen
                                           ; SOURCE LINE # 150
00A7 7BFF              MOV     R3,#0FFH
00A9 7A00        R     MOV     R2,#HIGH gui2_row0
00AB 7900        R     MOV     R1,#LOW gui2_row0
00AD 750005      R     MOV     ?_print_info?BYTE+04H,#05H
00B0 7F80              MOV     R7,#080H
00B2 120000      R     LCALL   _print_info
                                           ; SOURCE LINE # 151
00B5 7BFF              MOV     R3,#0FFH
00B7 7A00        R     MOV     R2,#HIGH gui2_row1
00B9 7900        R     MOV     R1,#LOW gui2_row1
00BB 750005      R     MOV     ?_print_info?BYTE+04H,#05H
00BE 7F90              MOV     R7,#090H
00C0 120000      R     LCALL   _print_info
                                           ; SOURCE LINE # 152
00C3 7BFF              MOV     R3,#0FFH
00C5 7A00        R     MOV     R2,#HIGH gui2_row2
00C7 7900        R     MOV     R1,#LOW gui2_row2
00C9 750005      R     MOV     ?_print_info?BYTE+04H,#05H
00CC 7F88              MOV     R7,#088H
00CE 120000      R     LCALL   _print_info
                                           ; SOURCE LINE # 153
00D1 7BFF              MOV     R3,#0FFH
00D3 7A00        R     MOV     R2,#HIGH gui2_row3
00D5 7900        R     MOV     R1,#LOW gui2_row3
00D7 750005      R     MOV     ?_print_info?BYTE+04H,#05H
00DA 7F98              MOV     R7,#098H
00DC 120000      R     LCALL   _print_info
                                           ; SOURCE LINE # 154
00DF 430002      R     ORL     lcd+01FH,#02H
                                           ; SOURCE LINE # 155
00E2 22                RET     
00E3         ?C0001:
                                           ; SOURCE LINE # 156
00E3 E500        R     MOV     A,lcd+01FH
00E5 30E024            JNB     ACC.0,?C0003
00E8         ?C0009:
                                           ; SOURCE LINE # 157
00E8 7D08              MOV     R5,#08H
00EA E4                CLR     A
00EB FF                MOV     R7,A
00EC 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 158
00EF 7F03              MOV     R7,#03H
00F1 120000      R     LCALL   _delay_ms
                                           ; SOURCE LINE # 159
00F4 7D01              MOV     R5,#01H
00F6 E4                CLR     A
00F7 FF                MOV     R7,A
00F8 120000      R     LCALL   _write_byte
                                           ; SOURCE LINE # 160
00FB 7F03              MOV     R7,#03H
00FD 120000      R     LCALL   _delay_ms
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 16  

                                           ; SOURCE LINE # 161
0100 C283              CLR     vdd_pin
                                           ; SOURCE LINE # 162
0102 C284              CLR     v0_pin
                                           ; SOURCE LINE # 163
0104 C293              CLR     led_a
                                           ; SOURCE LINE # 164
0106 5300FE      R     ANL     lcd+01FH,#0FEH
                                           ; SOURCE LINE # 165
0109 5300FD      R     ANL     lcd+01FH,#0FDH
                                           ; SOURCE LINE # 166
                                           ; SOURCE LINE # 167
010C         ?C0003:
010C 22                RET     
             ; FUNCTION _switch_lcd (END)

             ; FUNCTION display (BEGIN)
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 171
0000 E4                CLR     A
0001 F500        R     MOV     i,A
                                           ; SOURCE LINE # 172
0003 E500        R     MOV     A,lcd+01FH
0005 20E12F            JB      ACC.1,?C0011
0008         ?C0010:
                                           ; SOURCE LINE # 173
0008 7400        R     MOV     A,#LOW lcd+013H
000A 2500        R     ADD     A,lcd+011H
000C F8                MOV     R0,A
000D E6                MOV     A,@R0
000E 75F003            MOV     B,#03H
0011 A4                MUL     AB
0012 2400        R     ADD     A,#LOW error
0014 F582              MOV     DPL,A
0016 E4                CLR     A
0017 3400        R     ADDC    A,#HIGH error
0019 F583              MOV     DPH,A
001B E4                CLR     A
001C 93                MOVC    A,@A+DPTR
001D FB                MOV     R3,A
001E 7401              MOV     A,#01H
0020 93                MOVC    A,@A+DPTR
0021 FA                MOV     R2,A
0022 7402              MOV     A,#02H
0024 93                MOVC    A,@A+DPTR
0025 F9                MOV     R1,A
0026 8B00        R     MOV     lcd+0EH,R3
0028 8A00        R     MOV     lcd+0FH,R2
002A F500        R     MOV     lcd+010H,A
                                           ; SOURCE LINE # 174
002C 75000C      R     MOV     ?_print_info?BYTE+04H,#0CH
002F AF00        R     MOV     R7,lcd+0DH
0031 120000      R     LCALL   _print_info
                                           ; SOURCE LINE # 175
0034 430002      R     ORL     lcd+01FH,#02H
                                           ; SOURCE LINE # 176
0037         ?C0011:
0037 22                RET     
             ; FUNCTION display (END)

             ; FUNCTION L?0031 (BEGIN)
0000 E500        R     MOV     A,i
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 17  

0002 93                MOVC    A,@A+DPTR
0003 FD                MOV     R5,A
0004 7F01              MOV     R7,#01H
             ; FUNCTION _write_byte (BEGIN)
                                           ; SOURCE LINE # 215
0006 8F00        R     MOV     type,R7
0008 8D00        R     MOV     dat,R5
                                           ; SOURCE LINE # 216
000A 7500F8      R     MOV     head,#0F8H
                                           ; SOURCE LINE # 217
000D C287              CLR     clk_pin
                                           ; SOURCE LINE # 218
000F D285              SETB    cs_pin
                                           ; SOURCE LINE # 219
0011 120000      R     LCALL   check_busy
                                           ; SOURCE LINE # 220
0014 E500        R     MOV     A,type
0016 6003              JZ      ?C0012
                                           ; SOURCE LINE # 221
0018 430002      R     ORL     head,#02H
                                           ; SOURCE LINE # 222
001B         ?C0012:
                                           ; SOURCE LINE # 223
001B AF00        R     MOV     R7,head
001D 120000      R     LCALL   _send_bit
                                           ; SOURCE LINE # 224
0020 E500        R     MOV     A,dat
0022 54F0              ANL     A,#0F0H
0024 FF                MOV     R7,A
0025 120000      R     LCALL   _send_bit
                                           ; SOURCE LINE # 225
0028 E500        R     MOV     A,dat
002A C4                SWAP    A
002B 54F0              ANL     A,#0F0H
002D FF                MOV     R7,A
002E 120000      R     LCALL   _send_bit
                                           ; SOURCE LINE # 226
0031 7F01              MOV     R7,#01H
0033 120000      R     LCALL   _delay_us
                                           ; SOURCE LINE # 227
0036 C287              CLR     clk_pin
                                           ; SOURCE LINE # 228
0038 C285              CLR     cs_pin
                                           ; SOURCE LINE # 229
003A 22                RET     
             ; FUNCTION _write_byte (END)

             ; FUNCTION _send_bit (BEGIN)
                                           ; SOURCE LINE # 231
;---- Variable 'dat' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 232
;---- Variable 'i' assigned to Register 'R6' ----
0000 E4                CLR     A
0001 FE                MOV     R6,A
0002         ?C0014:
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
0002 C287              CLR     clk_pin
                                           ; SOURCE LINE # 235
0004 EF                MOV     A,R7
0005 33                RLC     A
0006 9286              MOV     sid_pin,C
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 18  

                                           ; SOURCE LINE # 236
0008 D287              SETB    clk_pin
                                           ; SOURCE LINE # 237
000A EF                MOV     A,R7
000B 25E0              ADD     A,ACC
000D FF                MOV     R7,A
                                           ; SOURCE LINE # 238
000E 0E                INC     R6
                                           ; SOURCE LINE # 239
000F BE08F0            CJNE    R6,#08H,?C0014
                                           ; SOURCE LINE # 240
0012         ?C0016:
0012 22                RET     
             ; FUNCTION _send_bit (END)

             ; FUNCTION check_busy (BEGIN)
                                           ; SOURCE LINE # 242
                                           ; SOURCE LINE # 243
0000 E4                CLR     A
0001 F500        R     MOV     res,A
                                           ; SOURCE LINE # 245
0003 22                RET     
             ; FUNCTION check_busy (END)

             ; FUNCTION clear_screen (BEGIN)
                                           ; SOURCE LINE # 247
                                           ; SOURCE LINE # 248
0000 7D01              MOV     R5,#01H
0002 E4                CLR     A
0003 FF                MOV     R7,A
0004 020000      R     LJMP    _write_byte
             ; FUNCTION clear_screen (END)

             ; FUNCTION _print_info (BEGIN)
                                           ; SOURCE LINE # 251
0000 8B00        R     MOV     arr,R3
0002 8A00        R     MOV     arr+01H,R2
0004 8900        R     MOV     arr+02H,R1
;---- Variable 'pos' assigned to Register 'R5' ----
0006 AD07              MOV     R5,AR7
                                           ; SOURCE LINE # 252
0008 E4                CLR     A
0009 F500        R     MOV     i,A
                                           ; SOURCE LINE # 253
000B FF                MOV     R7,A
000C 120000      R     LCALL   _write_byte
000F         ?C0019:
                                           ; SOURCE LINE # 254
000F E500        R     MOV     A,i
0011 C3                CLR     C
0012 9500        R     SUBB    A,len
0014 5019              JNC     ?C0021
                                           ; SOURCE LINE # 255
0016 AB00        R     MOV     R3,arr
0018 AA00        R     MOV     R2,arr+01H
001A A900        R     MOV     R1,arr+02H
001C 850082      R     MOV     DPL,i
001F 758300            MOV     DPH,#00H
0022 120000      E     LCALL   ?C?CLDOPTR
0025 FD                MOV     R5,A
0026 7F01              MOV     R7,#01H
0028 120000      R     LCALL   _write_byte
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 19  

                                           ; SOURCE LINE # 256
002B 0500        R     INC     i
                                           ; SOURCE LINE # 257
002D 80E0              SJMP    ?C0019
                                           ; SOURCE LINE # 258
002F         ?C0021:
002F 22                RET     
             ; FUNCTION _print_info (END)

             ; FUNCTION _delay_us (BEGIN)
                                           ; SOURCE LINE # 260
;---- Variable 'n' assigned to Register 'R7' ----
0000         ?C0022:
                                           ; SOURCE LINE # 261
0000 AE07              MOV     R6,AR7
0002 1F                DEC     R7
0003 EE                MOV     A,R6
0004 70FA              JNZ     ?C0022
0006         ?C0023:
                                           ; SOURCE LINE # 262
0006         ?C0024:
0006 22                RET     
             ; FUNCTION _delay_us (END)

             ; FUNCTION _delay_ms (BEGIN)
                                           ; SOURCE LINE # 263
;---- Variable 'n' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 264
;---- Variable 'i' assigned to Register 'R4/R5' ----
0000         ?C0025:
                                           ; SOURCE LINE # 265
0000 AE07              MOV     R6,AR7
0002 1F                DEC     R7
0003 EE                MOV     A,R6
0004 6010              JZ      ?C0029
                                           ; SOURCE LINE # 266
0006 7C02              MOV     R4,#02H
0008 7D9B              MOV     R5,#09BH
000A         ?C0027:
                                           ; SOURCE LINE # 267
000A ED                MOV     A,R5
000B 1D                DEC     R5
000C AA04              MOV     R2,AR4
000E 7001              JNZ     ?C0030
0010 1C                DEC     R4
0011         ?C0030:
0011 4A                ORL     A,R2
0012 60EC              JZ      ?C0025
0014 80F4              SJMP    ?C0027
                                           ; SOURCE LINE # 269
0016         ?C0029:
0016 22                RET     
             ; FUNCTION _delay_ms (END)

C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 20  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


cs_pin . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0085H  1
P0 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0080H  1
P1 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0090H  1
led_k. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0094H  1
P2 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
P3 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B0H  1
vss_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0082H  1
IEN0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
IEN1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
Lcd. . . . . . . . . . . . . . . . . .  * TAG *  -----  STRUCT   -----  32
  gui_id . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  buffer . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  12
  pos. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000DH  1
  str. . . . . . . . . . . . . . . . .  MEMBER   -----  PTR      000EH  3
  err_index. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0011H  1
  err_len. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0012H  1
  err_ids. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0013H  12
  on . . . . . . . . . . . . . . . . .  MEMBER   -----  FIELD    001FH  1.0
  updated. . . . . . . . . . . . . . .  MEMBER   -----  FIELD    001FH  1.1
S0CON2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
check_busy . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  res. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
gui3_rows. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02B8H  33
_switch_lcd. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  state. . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  i. . . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
error. . . . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02D9H  120
lcd. . . . . . . . . . . . . . . . . .  PUBLIC   DATA   STRUCT   0000H  32
TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
_print_info. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pos. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0005H  1
  arr. . . . . . . . . . . . . . . . .  AUTO     DATA   PTR      0001H  3
  len. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0004H  1
  i. . . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0005H  1
_write_byte. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0006H  -----
  type . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
  dat. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0001H  1
  head . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0002H  1
_send_bit. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  dat. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  i. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0006H  1
v0_pin . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0084H  1
_delay_ms. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  n. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  i. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
_delay_us. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  n. . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
gui2_row0. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02A4H  5
gui1_row1. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    0292H  9
clk_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0087H  1
gui2_row1. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02A9H  5
gui1_row2. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    029BH  9
S0CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
gui2_row2. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02AEH  5
gui2_row3. . . . . . . . . . . . . . .  PUBLIC   CODE   ARRAY    02B3H  5
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
vdd_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0083H  1
C51 COMPILER V9.56.0.0   LCD                                                               03/01/2021 16:54:13 PAGE 21  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


sid_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0086H  1
clear_screen . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
psb_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0090H  1
ret_pin. . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0091H  1
led_a. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0093H  1
display. . . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0000H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
IRCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    492    ----
   CONSTANT SIZE    =    849    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     32      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
